<div class='post'>
There are two compilers available for D. The original D compiler (the one written by Walter) is DMD. It has an open-source front-end (the part that generate the IL) and a proprietary, closed-source back-end (the part that converts the IL into machine code). Two other, fully open-source compilers exist, GDC and LDC, which use the <a href="http://gcc.gnu.org/">GCC</a> and <a href="http://llvm.org/">LLVM</a> back-ends respectively.<br /><br />I like using GDC, because it's open-source and has <a href="http://www.digitalmars.com/d/archives/digitalmars/D/learn/How_to_create_a_shared_library_with_DMD_on_Linux_5740.html">better support</a> for shared library linking on Unices. It's fairly easy to switch between GDC and DMD, as GDC includes a <tt>gdmd</tt> command which emulates the command-line behavior of DMD. <br /><br />Previously I was using <a href="http://www.dsource.org/projects/dsss">DSSS</a> to build my D projects. While DSSS is very nice in many ways, it felt odd using a build tool that was really only popular in the D community. After we started using <a href="http://www.scons.org/">SCons</a> at <a href="http://appcelerator.org/" title="More Tap, Less Foxtrot">work</a>, I was positively pickled to find that it supported building D code. SCons works just as easily for D code as it does for building other things.<br /><br />Say you have a source file containing your ground-breaking implementation of the Smash Mouth Optimization (see Computational Football vol. 23), SmashMouth.d. To build this with SCons, simply create a SConstruct file that looks like this:<br /><pre>BuildDir('build', 'src')<br />e = Environment()<br />e.Program('build/SmashMouth.d')</pre>This assumes that you have your source in a folder called <tt>src</tt> and you want to build into a folder called <tt>build</tt> (I know, I know...this is a pretty brazen assumption). Running <tt>scons</tt> should produce something like this:<br /><pre>scons: Reading SConscript files ...<br />scons: done reading SConscript files.<br />scons: Building targets ...<br />gcc -o build/Test build/Test.o -lgphobos -lpthread -lm -lgphobos -lgphobos -lgphobos<br />scons: done building targets.</pre>You can see here that scons decided to build using GDC and Phobos. The SCons D scanner is pretty smart about what compilers you have on your system. It's also configurable. Okay, here comes the magical wonderland part.<br /><br />What happens when you decide that you want SmashMouthOptimizer to be a shared library? You have some options here.<br /><ul><br /><li>You could simply look through all the man pages of the D compilers you are using, hunt for all the relevant linking options, and finally write conditional code in your Makefile to use them.</li><br /><li>On the other hand, you could just change your SConstruct to look like this:<br /><pre>BuildDir('build', 'src')<br />e = Environment()<br />e.SharedLibrary('build/SmashMouth.d')</pre>Then let <tt>scons</tt> do this:<br /><pre>scons: Reading SConscript files ...<br />scons: done reading SConscript files.<br />scons: Building targets ...<br />gdmd -I. -c -ofbuild/SmashMouth.os build/SmashMouth.d<br />gcc -o build/libSmashMouth.so -shared build/SmashMouth.os<br />scons: done building targets.</pre><br /></li></ul></div>
